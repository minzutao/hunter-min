<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />




<link rel="stylesheet" href="/style.css" type="text/css" />


<title>shell脚本速查</title>
<meta name="keywords" content="linux,script,使用,教程,笔记,数组,分支,循环,函数">

</head>


<body>
<div id="wrapper">

<div id="header">
    <p class="header_titleline">Mike的分享空间</p>
    <p class="header_subline"><a href="/index.html">首页</a></p>
</div>

<h1>shell脚本速查</h1>
<p>date: 2013.05.23; modification:2014.04.11</p>

 <!--if(title)-->

<p>目录:</p>
<div id="TOC">
<ul>
<li><a href="#变量"><span class="toc-section-number">1</span> 变量</a><ul>
<li><a href="#特殊变量"><span class="toc-section-number">1.1</span> 特殊变量</a></li>
</ul></li>
<li><a href="#数组"><span class="toc-section-number">2</span> 数组</a><ul>
<li><a href="#声明"><span class="toc-section-number">2.1</span> 声明</a></li>
<li><a href="#定义"><span class="toc-section-number">2.2</span> 定义</a></li>
<li><a href="#访问"><span class="toc-section-number">2.3</span> 访问</a></li>
<li><a href="#删除"><span class="toc-section-number">2.4</span> 删除</a></li>
<li><a href="#计算数组长度"><span class="toc-section-number">2.5</span> 计算数组长度</a></li>
<li><a href="#数组截取"><span class="toc-section-number">2.6</span> 数组截取</a></li>
<li><a href="#子串删除与替换"><span class="toc-section-number">2.7</span> 子串删除与替换</a></li>
</ul></li>
<li><a href="#函数"><span class="toc-section-number">3</span> 函数</a></li>
<li><a href="#条件测试"><span class="toc-section-number">4</span> 条件测试</a><ul>
<li><a href="#文件"><span class="toc-section-number">4.1</span> 文件</a></li>
<li><a href="#字符串"><span class="toc-section-number">4.2</span> 字符串</a></li>
<li><a href="#数值"><span class="toc-section-number">4.3</span> 数值</a></li>
<li><a href="#逻辑运算符"><span class="toc-section-number">4.4</span> 逻辑运算符</a></li>
<li><a href="#特殊条件测试"><span class="toc-section-number">4.5</span> 特殊条件测试</a></li>
</ul></li>
<li><a href="#分支与循环"><span class="toc-section-number">5</span> 分支与循环</a><ul>
<li><a href="#if"><span class="toc-section-number">5.1</span> if</a></li>
<li><a href="#case"><span class="toc-section-number">5.2</span> case</a></li>
<li><a href="#while"><span class="toc-section-number">5.3</span> while</a></li>
<li><a href="#until"><span class="toc-section-number">5.4</span> until</a></li>
<li><a href="#for"><span class="toc-section-number">5.5</span> for</a></li>
</ul></li>
<li><a href="#shell输入与输出"><span class="toc-section-number">6</span> shell输入与输出</a><ul>
<li><a href="#echo"><span class="toc-section-number">6.1</span> echo</a></li>
<li><a href="#read"><span class="toc-section-number">6.2</span> read</a></li>
<li><a href="#cat"><span class="toc-section-number">6.3</span> cat</a></li>
<li><a href="#标准输入-输出-错误输出"><span class="toc-section-number">6.4</span> 标准输入, 输出, 错误输出</a></li>
<li><a href="#tee"><span class="toc-section-number">6.5</span> tee</a></li>
<li><a href="#管道"><span class="toc-section-number">6.6</span> 管道</a></li>
</ul></li>
<li><a href="#算术运算"><span class="toc-section-number">7</span> 算术运算</a><ul>
<li><a href="#简单运算不支持浮点"><span class="toc-section-number">7.1</span> 简单运算(不支持浮点)</a></li>
<li><a href="#复杂运算"><span class="toc-section-number">7.2</span> 复杂运算</a></li>
</ul></li>
<li><a href="#常用命令与语句"><span class="toc-section-number">8</span> 常用命令与语句</a><ul>
<li><a href="#exit"><span class="toc-section-number">8.1</span> exit</a></li>
<li><a href="#select"><span class="toc-section-number">8.2</span> select</a></li>
<li><a href="#sort"><span class="toc-section-number">8.3</span> sort</a></li>
</ul></li>
<li><a href="#小技巧"><span class="toc-section-number">9</span> 小技巧</a><ul>
<li><a href="#获取某程序的进程号"><span class="toc-section-number">9.1</span> 获取某程序的进程号</a></li>
<li><a href="#获取进程的环境"><span class="toc-section-number">9.2</span> 获取进程的环境</a></li>
</ul></li>
<li><a href="#参考资料"><span class="toc-section-number">10</span> 参考资料</a></li>
</ul>
</div>
 <!--if(toc)-->

<!---title:shell脚本速查-->
<!---keywords:linux,script,使用,教程,笔记,数组,分支,循环,函数-->
<!---date:2013.05.23; modification:2014.04.11-->


<h1 id="变量"><span class="header-section-number">1</span> 变量</h1>
<p>var=&quot;hello&quot;</p>
<p>len=${#var} # 获得字符串长度</p>
<h2 id="特殊变量"><span class="header-section-number">1.1</span> 特殊变量</h2>
<ul>
<li>$#: 命令行上的参数个数(不包括命令本身).</li>
<li>$?: 上一条命令执行后的返回值.</li>
<li>$$: 当前进程的进程号. 可用于生成唯一的临时文件名: temp=/usr/tmp/$$</li>
<li>$!: 上一个后台命令对应的进程号.</li>
<li>$-: 由当前shell设置的执行标志名组成的字符串(即命令行选项的出'-'之外的部分).</li>
<li>$*: 命令行中实际给出的所有实参字符串, 不仅限于9个.</li>
<li><p><span class="math">$@: 与$</span>*基本功能相同. $*将所有参数串成一个串, 而$@将其分成多个串.</p></li>
<li><p>$UID: user id. 超级用户的UID为0.</p></li>
</ul>
<h1 id="数组"><span class="header-section-number">2</span> 数组</h1>
<h2 id="声明"><span class="header-section-number">2.1</span> 声明</h2>
<pre><code>declare -a myarray # myarray被当作数组名</code></pre>
<p>bash中可以不声明, 直接定义.</p>
<h2 id="定义"><span class="header-section-number">2.2</span> 定义</h2>
<p><strong>第1种方式</strong>: 数组元素内部没有空格</p>
<pre><code>myarray=( value1 value2 value3 ... )
或:
myarray=&quot;one two three&quot;</code></pre>
<p><strong>第2种方式</strong>: 数组元素内部包含空格</p>
<pre><code>cmds[0]=&quot;git checkout master&quot;
cmds[1]=&quot;git pull&quot;</code></pre>
<h2 id="访问"><span class="header-section-number">2.3</span> 访问</h2>
<pre><code>${myarray[key]}   # 访问单个数组元素. 例如: cmds[1]
${myarray[*]}     # 访问所有元素
${myarray[@]}     # 访问所有元素(每个元素作为一个参数, 即使包括空格)</code></pre>
<h2 id="删除"><span class="header-section-number">2.4</span> 删除</h2>
<pre><code>unset myarray[1]  # 删除数组中第一个元素
unset myarray     # 删除整个数组</code></pre>
<h2 id="计算数组长度"><span class="header-section-number">2.5</span> 计算数组长度</h2>
<pre><code>${#myarray[*]}    # 获取数组长度(元素总个数).
${#myarray[@]}    # 获取数组长度(元素总个数).
${#myarray[0]}    # 获取元素0的长度.</code></pre>
<h2 id="数组截取"><span class="header-section-number">2.6</span> 数组截取</h2>
<pre><code>${myarray[*]:1}   # 截取: 从下标为1的元素到最后一个
${myarray[*]:2:3} # 截取: 从下标为2(含2)的元素开始, 截取3个元素</code></pre>
<h2 id="子串删除与替换"><span class="header-section-number">2.7</span> 子串删除与替换</h2>
<p>会将所有的元素中的匹配到的子串删除/替换.</p>
<pre><code>array=(&quot;zero&quot; &quot;one&quot; &quot;two&quot; &quot;three&quot; &quot;four&quot; &quot;soho&quot;)

#删除:
echo ${array[@]#t*e}   # 从字符串的起始开始最短匹配: &quot;t*e&quot;, 这将匹配到&quot;thre&quot;. 将显示: zero one two e four soho
echo ${array[@]##t*e}  # 从字符串的起始开始最长匹配, 这将匹配到&quot;three&quot;. 将显示: zero one two four soho
echo ${array[@]%o*}    # 从字符串的结尾开始最短匹配. 将显示: zer tw three f soh
echo ${array[@]%%o*}   # 从字符串的结尾开始最长匹配. 将显示: zer tw three f s

#替换:
echo ${array[@]/e/+}   # 从字符串的任意位置开始最短的匹配并替换. 将显示: z+ro on+ two thr+e four soho
echo ${array[@]//e/+}  # 从字符串的任意位置开始最长的匹配并替换. 将显示: z+ro on+ two thr++ four soho
echo ${array[@]/#o/+}  # 从字符串的起始开始匹配并替换. 将显示: zero +ne two three four soho
echo ${array[@]/%o/+}  # 从字符串的结尾开始匹配并替换. 将显示: zer+ one tw+ three four soh+</code></pre>
<h1 id="函数"><span class="header-section-number">3</span> 函数</h1>
<pre class="brush: shell; toolbar: false">
    function func1()
    {
         echo `expr $1 \+ $2`
         return `expr $1 - $2`
    }

    func1 11 1          # 显示输出为12

    ret=`func1 11 1`    # 无显示输出
    echo $?             # 显示输出为10
    echo $ret           # 显示输出为12
</pre>

<p>说明: * func1中return的值并不是存在变量ret中, 而是在$?中, 这点与大多语言不同. * 被赋值的变量ret, 其实存的是func1中用echo, cat等终端打印的内容.</p>
<h1 id="条件测试"><span class="header-section-number">4</span> 条件测试</h1>
<h2 id="文件"><span class="header-section-number">4.1</span> 文件</h2>
<pre><code>  1] -r file      : 可读为真
  2] -w file      : 可写为真
  3] -x file      : 可执行为真
  4] -f file      : 存在且是普通文件为真
  5] -d file      : 存在且是目录文件为真
  6] -p file      : 存在且是命名的FIFO文件为真
  7] -b file      : 存在且是块设备文件为真
  8] -c file      : 存在且是字符设备文件为真
  9] -s file      : 存在且长度&gt;0为真
  10]-t 文件描述字: 文件打开且其文件描述字是与终端设备相关的为真. 默认的&quot;文件描述字&quot;是1.</code></pre>
<h2 id="字符串"><span class="header-section-number">4.2</span> 字符串</h2>
<pre><code>  1] -z s1   : 长度为0为真
  2] -n s1   : 长度&gt;0为真
  3] s1      : 不是空串则为真
  4] s1 = s2 : 串相等为真
  5] s1 != s2: 串不等为真
  6] s1 &lt;  s2: 字典顺序s1在s2前为真
  7] s1 &gt;  s2: 字典顺序s1在s2后为真</code></pre>
<h2 id="数值"><span class="header-section-number">4.3</span> 数值</h2>
<pre><code>  1] n1 -eq n2: 等于为真
  2] n1 -ne n2: 不等为真
  3] n1 -lt n2: 小于为真
  4] n1 -le n2: 小于等于为真
  5] n1 -gt n2: 大于为真
  6] n1 -ge n2: 大于等于为真</code></pre>
<h2 id="逻辑运算符"><span class="header-section-number">4.4</span> 逻辑运算符</h2>
<pre><code>  1] !: 逻辑非
  2] -a: 逻辑与
  3] -o: 逻辑或</code></pre>
<h2 id="特殊条件测试"><span class="header-section-number">4.5</span> 特殊条件测试</h2>
<pre><code>  1] :: 不做任何事, 退出值为0(真).
  2] true: 总为真, 退出值为0.
  3] false: 总为假, 退出值为255.</code></pre>
<h1 id="分支与循环"><span class="header-section-number">5</span> 分支与循环</h1>
<h2 id="if"><span class="header-section-number">5.1</span> if</h2>
<pre><code>if 条件; then
    cmd1
else
    cmd2
fi</code></pre>
<h2 id="case"><span class="header-section-number">5.2</span> case</h2>
<pre><code>case 字符串 in
    模式1) cmd1
        ;;
    模式2) cmd2
        ;;
esac</code></pre>
<h2 id="while"><span class="header-section-number">5.3</span> while</h2>
<pre><code>while 测试条件
    cmd
done</code></pre>
<p>可以使用break</p>
<h2 id="until"><span class="header-section-number">5.4</span> until</h2>
<pre><code>until 测试条件
do
    命令表
done</code></pre>
<h2 id="for"><span class="header-section-number">5.5</span> for</h2>
<pre><code>for 变量 [in 值表]
do
    cmd
done</code></pre>
<h1 id="shell输入与输出"><span class="header-section-number">6</span> shell输入与输出</h1>
<h2 id="echo"><span class="header-section-number">6.1</span> echo</h2>
<p>选项:</p>
<pre><code>-e: 翻译反斜杠&#39;\&#39;的转意.
-E: 不翻译反斜杠&#39;\&#39;的转意.</code></pre>
<p>-e的转意:</p>
<pre><code>\c: 不换行.
\n: 换行.
\r: 回车.
\t: tab.
\v: 纵向tab(不回车的换行).</code></pre>
<h2 id="read"><span class="header-section-number">6.2</span> read</h2>
<p>用法: read var1 var2 (以空格为分隔, 回车为结束)</p>
<p>如果不能一一对应, 多余的全部给最后一个变量.</p>
<h2 id="cat"><span class="header-section-number">6.3</span> cat</h2>
<p>用法1: 显示</p>
<pre><code>cat file1
cat file1 | more
cat -v file1 #(显示控制字符)</code></pre>
<p>用法2: 合并文本文件</p>
<pre><code>cat file1 file2 &gt; file_tar</code></pre>
<p>用法3: 简单文本录入器</p>
<pre><code>cat &gt; file1 #(键盘读入字段, 输入到file1, 以&lt;Ctrl+D&gt;结束)</code></pre>
<h2 id="标准输入-输出-错误输出"><span class="header-section-number">6.4</span> 标准输入, 输出, 错误输出</h2>
<p>标准输入, 输出, 错误输出分别为0, 1, 2</p>
<pre><code>cmd &gt; file1 2&gt;&amp;1 # 标准输出和标准错误一起重定向.
cmd &gt; /dev/null  # 重定向到垃圾箱
cat file1.txt file2.txt 1&gt;file3.out 2&gt;file4.err # 标准输出和标准错误一起使用.</code></pre>
<h2 id="tee"><span class="header-section-number">6.5</span> tee</h2>
<p>把输出的一个副本输送到标准输出, 另一个副本拷贝到相应的文件中.</p>
<p>选项: -a: 追加.</p>
<h2 id="管道"><span class="header-section-number">6.6</span> 管道</h2>
<pre><code>time=`date|awk &#39;{print $5}&#39;|sed -e &#39;s/://g&#39;`
并且awk和sed一次完成不了的, 可以分多次一直管道, 直到完成.</code></pre>
<h1 id="算术运算"><span class="header-section-number">7</span> 算术运算</h1>
<h2 id="简单运算不支持浮点"><span class="header-section-number">7.1</span> 简单运算(不支持浮点)</h2>
<pre><code>a=`expr ${a} + 1`</code></pre>
<p>或</p>
<pre><code>let a=1+2
let a++     # 或 let a--
let a+=6</code></pre>
<p>或</p>
<pre><code>a=$[$b + 1]</code></pre>
<h2 id="复杂运算"><span class="header-section-number">7.2</span> 复杂运算</h2>
<pre><code>echo &quot;3.14 * 2.54&quot; | bc
echo &quot;scale=2;3/8&quot; | bc  # scale=2参数表示小数位为2. 参数由分号分割.
echo &quot;obase=16;ibase=2;0101010110101010&quot; | bc  # 进制转换
echo &quot;10^10&quot; | bc  # 计算平方
echo &quot;sqrt(100)&quot; | bc  # 计算平方根, 结果为整数
echo &quot;sqrt(100.01)&quot; | bc  # 计算平方根, 结果为小数, 小数位数为后面.01的位数相同.</code></pre>
<h1 id="常用命令与语句"><span class="header-section-number">8</span> 常用命令与语句</h1>
<h2 id="exit"><span class="header-section-number">8.1</span> exit</h2>
<pre><code>exit [n]  : n缺省则为最后一条命令的退出值.</code></pre>
<h2 id="select"><span class="header-section-number">8.2</span> select</h2>
<pre><code>select id [in word ...]
do
    cmd
done</code></pre>
<h2 id="sort"><span class="header-section-number">8.3</span> sort</h2>
<p>说明: 一般处理类似表格的文本文件. 将其一列一列的进行分类, 切割, 合并等.</p>
<p>选项:</p>
<pre><code>-c: 测试是否已经分类.
-m: 合并两个分类的文件.
-u: 省略重复行.
-o file1: 将结果存入file1.
-b: 忽略前导空白.
-n: 按数字分类. 如: 123比89大.
-t: 制定分隔符.
-r: 逆序排列.
-ki: i指示第i域开始分类. i从1开始数.</code></pre>
<h1 id="小技巧"><span class="header-section-number">9</span> 小技巧</h1>
<h2 id="获取某程序的进程号"><span class="header-section-number">9.1</span> 获取某程序的进程号</h2>
<pre><code>pgrep vim</code></pre>
<h2 id="获取进程的环境"><span class="header-section-number">9.2</span> 获取进程的环境</h2>
<pre><code>cat /proc/$$/environ | tr &#39;\0&#39; &#39;\n&#39;</code></pre>
<h1 id="参考资料"><span class="header-section-number">10</span> 参考资料</h1>
<p><a href="http://bbs.chinaunix.net/thread-1779167-1-1.html">http://bbs.chinaunix.net/thread-1779167-1-1.html</a></p>
<!-- vim:set tw=0:-->


<div id="footer">
    <p class="footer_titleline">Human knowledge belongs to the world</p>
    <p class="footer_subline">Contact: wytabc@126.com</p>
    <p class="footer_subline">声明: 本站如有侵权行为请及时通知至以上邮箱</p>
</div>
<!--Baidu tongji-->
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcb5b32b959ab6deadbf7373854572a73' type='text/javascript'%3E%3C/script%3E"));
</script> <!--Baidu tongji-->
</div> <!--wrapper-->

<!--SyntaxHighlighter-->
<script type="text/javascript" src="/scripts/shCore.js"></script>
<script type="text/javascript" src="/scripts/shBrushBash.js"></script>
<script type="text/javascript" src="/scripts/shBrushPython.js"></script>
<script type="text/javascript" src="/scripts/shBrushCpp.js"></script>
<script type="text/javascript" src="/scripts/shBrushJScript.js"></script>
<script type="text/javascript" src="/scripts/shBrushJava.js"></script>
<script type="text/javascript" src="/scripts/shBrushXml.js"></script>
<link type="text/css" rel="stylesheet" href="/styles/shCoreFadeToGrey.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>

</body>
</html>
